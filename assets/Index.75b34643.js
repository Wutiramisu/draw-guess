import{o as e,c as t,b as a,p as l,h as s,r as o,m as n,n as i,u as r,q as u,s as d,w as c,t as v,x as p,y as g,z as m,A as x,B as b,C as f,D as h,E as y,F as w,v as k,G as C,H as _,I as S,T as A,k as P}from"./vendor.5e143dbf.js";const W={class:"whitespace-nowrap px-2 mx-1"},j={expose:[],props:{icon:String},setup(l){const s=l;return(l,o)=>(e(),t("button",W,[a("i",{class:["text-2xl",s.icon]},null,2)]))}},B={class:"whitespace-nowrap px-2 mx-1"},V=a("span",null,"Size",-1),I=a("option",{value:"2"},"2",-1),M=a("option",{value:"6"},"6",-1),T=a("option",{value:"10"},"10",-1),F={expose:[],props:{modelValue:Number},emits:["update:modelValue"],setup:(l,{emit:s})=>(s,o)=>(e(),t("div",B,[V,a("select",{value:l.modelValue,onChange:o[1]||(o[1]=e=>s.$emit("update:modelValue",Number(e.target.value))),class:"focus:outline-none cursor-pointer pl-2 bg-gray-100"},[I,M,T],40,["value"])]))};l("data-v-6a403780");const N={class:"w-auto"},$={class:"flex items-center"};s();const E={expose:[],props:{modelValue:Number},emits:["onPencil","onEraser","clearAll","changeWidth"],setup(l,{emit:s}){const i=o(!0),r=()=>{i.value=!i.value},u=o(2);n(u,(e=>{s("changeWidth",e)}));const d=()=>s("onPencil"),c=()=>s("onEraser"),v=()=>s("clearAll");return(l,s)=>(e(),t("div",N,[a("div",{class:["bg-gray-100 rounded-full shadow-sm flex transition-all duration-500 overflow-hidden",{"w-12":!i.value,"w-full":i.value}]},[a("button",{class:"flex items-center bg-gray-100 rounded-full p-3",onClick:r},[a("span",{class:["material-icons transform transition-transform duration-500",{"icon-flip":i.value}]}," arrow_forward_ios ",2)]),a("div",$,[a(j,{icon:"bi bi-pencil-fill",onClick:d}),a(j,{icon:"bi bi-eraser-fill",onClick:c}),a(F,{modelValue:u.value,"onUpdate:modelValue":s[1]||(s[1]=e=>u.value=e)},null,8,["modelValue"]),a(j,{icon:"bi bi-trash-fill",onClick:v})])],2)]))},__scopeId:"data-v-6a403780"};l("data-v-44a9e53b");const H={class:"relative w-fit"};s();const O={expose:[],props:{drawable:Boolean,area:Object},setup(l){const s=l;i((e=>({f7c523de:m})));const n=r().getters.socket,p=o(null);let g=null;const m="#FFF",x="#01936F",b=m;let f=!1;const h=e=>{s.drawable&&(f=!0,g.beginPath(),g.moveTo(e.offsetX,e.offsetY),n.emit("startPoint",e.offsetX,e.offsetY))},y=e=>{f&&s.drawable&&(g.lineTo(e.offsetX,e.offsetY),g.stroke(),n.emit("drawing",e.offsetX,e.offsetY))},w=()=>{f=!1},k=()=>{f=!1},C=()=>{g.strokeStyle=x,n.emit("pencilMode")},_=()=>{g.strokeStyle=b,n.emit("eraserMode")},S=e=>{g.lineWidth=e,n.emit("changeLineWidth",e)},A=()=>{g.clearRect(0,0,p.value.clientWidth,p.value.clientHeight),n.emit("clearAll")};return u((()=>{p.value.width=s.area.width,p.value.height=s.area.height,g=p.value.getContext("2d"),g.lineCap="round",g.lineJoin="round",g.strokeStyle=x,g.lineWidth=2,n.on("beforeSketching",((e,t)=>{g.beginPath(),g.moveTo(e,t)})),n.on("sketching",((e,t)=>{g.lineTo(e,t),g.stroke()})),n.on("pencilMode",(()=>{C()})),n.on("eraserMode",(()=>{_()})),n.on("changeLineWidth",(e=>{g.lineWidth=e})),n.on("clearAll",(()=>{g.clearRect(0,0,p.value.clientWidth,p.value.clientHeight)}))})),d((()=>{n.disconnect()})),(l,o)=>(e(),t("div",H,[c(a(E,{class:"absolute top-4 left-4",onOnEraser:_,onOnPencil:C,onClearAll:A,onChangeWidth:S},null,512),[[v,s.drawable]]),a("canvas",{ref:p,class:"canvas rounded",onMousedown:h,onMousemove:y,onMouseup:w,onMouseleave:k},null,544)]))},__scopeId:"data-v-44a9e53b"};l("data-v-72946816");const X={class:"flex flex-col justify-center items-center"},Y={class:"text-blue-500 text-3xl font-bold"},R={key:0,class:"base bg-blue-500 border-4 border-blue-200 mt-8"},z=x("題目: "),K={key:0,class:"bi bi-check-lg ml-3 text-green-500"};s();const L={expose:[],props:{toggle:Boolean},emits:["button-click"],setup(l,{emit:s}){const n=()=>{s("button-click")},i=p(),r=o(i.slots.topic);return(s,o)=>(e(),t("div",X,[a("div",Y,[g(s.$slots,"title",{},void 0,!0)]),r.value?(e(),t("div",R,[z,g(s.$slots,"topic",{},void 0,!0)])):m("",!0),a("button",{class:["base bg-white mt-8 shadow-md transform border-4 border-green-500",{"active:scale-95":!l.toggle,"active:shadow-none":!l.toggle,"":l.toggle}],disabled:l.toggle,onClick:n},[a("span",{class:{"text-gray-300":!l.toggle,"text-green-500":l.toggle}},[g(s.$slots,"button-desc",{},void 0,!0)],2),l.toggle?(e(),t("i",K)):m("",!0)],10,["disabled"])]))},__scopeId:"data-v-72946816"},U={class:"bg-yellow-100 flex justify-center items-center"},q={key:0,class:"flex flex-col justify-center items-center"},D=a("div",{class:"text-blue-500 text-3xl font-bold"},"等待玩家...",-1),G=x("遊戲結束"),J=x("繼續遊戲"),Q={key:2},Z=x("輪到你畫!"),ee=x("準備完成"),te=x("輪到你猜!"),ae=x("準備完成"),le={expose:[],props:{topic:String},setup(a){const l=a,s=r().getters.socket,n=o(!0),i=o(void 0),d=o(!0),c=o(!1),v=()=>{c.value=!0,s.emit("next game")},p=o(!1),g=()=>{p.value=!0,s.emit("ready")},h=()=>{s.on("to ready step",(e=>{n.value=!1,i.value=e[s.id].identity})),s.on("all next game",(()=>{d.value=!0})),s.on("game timeout",(()=>{p.value=!1,d.value=!1,c.value=!1,i.value=void 0}))};return u((()=>{h()})),(a,s)=>(e(),t("div",U,[n.value?(e(),t("div",q,[D])):d.value?(e(),t("div",Q,["painter"===i.value?(e(),t(L,{key:0,onButtonClick:g,toggle:p.value},{topic:b((()=>[x(f(l.topic),1)])),title:b((()=>[Z])),"button-desc":b((()=>[ee])),_:1},8,["toggle"])):m("",!0),"guesser"===i.value?(e(),t(L,{key:1,onButtonClick:g,toggle:p.value},{title:b((()=>[te])),"button-desc":b((()=>[ae])),_:1},8,["toggle"])):m("",!0)])):(e(),t(L,{key:1,onButtonClick:v,toggle:c.value},{title:b((()=>[G])),"button-desc":b((()=>[J])),_:1},8,["toggle"]))]))}},se={class:"bg-transparent border-4 border-red-600 rounded-full w-14 h-14 relative"},oe={class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-2xl"},ne={expose:[],props:{time:Number,start:Boolean},emits:["timeout"],setup(l,{emit:s}){const i=l,r=h(i,"start");n(r,(e=>{e&&c()}));const u=o(i.time);let d;const c=()=>{u.value=i.time,d=setInterval((()=>{0===u.value?v(d):u.value--}),1e3)},v=e=>{clearInterval(e),s("timeout")};return y((()=>{clearInterval(d)})),(l,s)=>(e(),t("div",se,[a("span",oe,f(u.value),1)]))}},ie=a("span",{class:"text-gray-400 text-xs"},"[遊戲]",-1),re={class:"mx-1 text-black"},ue={key:0},de={key:1},ce={key:1,class:"px-2 py-1 flex items-center text-gray-400"},ve=a("span",{class:"text-gray-400 text-xs"},"[系統]",-1),pe={class:"mx-1 text-black"},ge={expose:[],props:{data:Object,index:Number},setup(l){const s=l;return(l,o)=>(e(),t(w,null,["game"===s.data.type?(e(),t("li",{key:0,class:["px-2 py-1 flex items-center",{"bg-green-50":s.data.status,"bg-red-50":!s.data.status,"text-green-500":s.data.status,"text-red-500":!s.data.status}]},[ie,a("span",re,f(s.data.user),1),s.data.status?(e(),t("span",ue,"答對了")):(e(),t("span",de,"答錯了"))],2)):m("",!0),"system"===s.data.type?(e(),t("li",ce,[ve,a("span",pe,f(s.data.user),1),a("span",null,f(s.data.msg),1)])):m("",!0)],64))}},me={class:"flex items-stretch"},xe={expose:[],emits:["sendAnswer"],setup(l,{emit:s}){const n=o(""),i=()=>{""!==n.value&&(s("sendAnswer",n.value),n.value="")};return(l,s)=>(e(),t("div",me,[c(a("input",{type:"text",class:"px-2 py-1.5 rounded-l flex-1 text-lg",placeholder:"請輸入答案","onUpdate:modelValue":s[1]||(s[1]=e=>n.value=e),onKeyup:C(i,["enter"])},null,40,["onKeyup"]),[[k,n.value,void 0,{trim:!0}]]),a("button",{class:"bg-green-500 text-white px-4 rounded-r",onClick:i},"確定")]))}},be={class:"bg-gray-200"},fe={expose:[],props:{isPainter:Boolean,isStarted:Boolean},setup(l){const s=l,n=o([]),i=r().getters.socket,d=o(null),c=e=>{i.emit("answer",e)};return u((()=>{i.on("user join",(e=>{n.value.push(e)})),i.on("user leave",(e=>{n.value.push(e)})),i.on("answering result",(e=>{n.value.push(e)}))})),_((()=>{d.value.scrollTop=d.value.scrollHeight})),(l,o)=>(e(),t("div",be,[a("ul",{class:"bg-white overflow-y-scroll h-[200px]",ref:d},[(e(!0),t(w,null,S(n.value,((a,l)=>(e(),t(ge,{key:l,data:a,index:l},null,8,["data","index"])))),128))],512),!s.isPainter&&s.isStarted?(e(),t(xe,{key:0,class:"mt-1",onSendAnswer:c})):m("",!0)]))}};const he=P();l("data-v-414a17a6");const ye={class:"py-4 px-3 mx-auto bg-gray-200 rounded-t-3xl select-none"},we={class:"flex justify-center items-center relative"},ke={class:"rounded-full border-4 border-blue-200 bg-blue-500 text-2xl text-white px-4 py-2"},Ce={key:0},_e={key:1};s();const Se={expose:[],setup(l){const s=r(),n=s.getters.socket,i={width:1e3,height:500},p=o(void 0),g={painter:"輪到你畫",guesser:"輪到你猜"},m=o(!1),x=o(!1),b=o(!1),h=o(void 0),y=o(void 0),w=()=>{m.value=!0,"painter"===p.value&&(x.value=!0,setTimeout((()=>{y.value=`題目: ${h.value}`}),900))},k=()=>{n.emit("game timeout"),x.value=!1,m.value=!1};return u((()=>{n.on("to ready step",((e,t)=>{h.value=t,p.value=e[n.id].identity,"painter"===p.value?b.value=!0:b.value=!1,y.value=g[p.value]})),n.on("all ready",(()=>{w()})),n.emit("join server",s.getters.name)})),d((()=>{n.emit("leave server",s.getters.name)})),(l,s)=>(e(),t("div",ye,[a("div",we,[a("div",ke,[p.value?(e(),t("span",Ce,f(y.value),1)):(e(),t("span",_e,"等待中"))]),a(ne,{class:"absolute right-0",start:m.value,time:30,onTimeout:k},null,8,["start"])]),a("div",{class:"overflow-hidden border-blue-200 border-2 mx-auto my-4 relative",style:{width:i.width+"px",height:i.height+"px"}},[a(O,{area:i,drawable:x.value},null,8,["drawable"]),a(A,null,{default:he((()=>[c(a(le,{class:"absolute bottom-0 left-0",style:{width:i.width+"px",height:1.05*i.height+"px"},topic:h.value,onAllReady:w},null,8,["style","topic"]),[[v,!m.value]])])),_:1})],4),a(fe,{class:"w-full",isPainter:b.value,isStarted:m.value},null,8,["isPainter","isStarted"])]))},__scopeId:"data-v-414a17a6"};export default Se;
